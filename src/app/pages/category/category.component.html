<!-- Contenedor principal -->
<div class="mb-6 grid grid-cols-1 xl:grid-cols-1 gap-6 ">
  <div class="relative flex flex-col bg-white rounded-xl shadow-lg overflow-hidden border border-gray-200">

    <!-- Header -->
    <div
      class="flex items-center justify-between p-6 bg-gradient-to-r from-sky-800 to-sky-800 text-white rounded-t-xl shadow-md">
      <div>
        <h6 class="text-xl font-bold tracking-wide">Tareas</h6>
        <p class="text-sm flex items-center gap-2 opacity-90">
          <strong class="text-xl">{{ taskTypeDisplayName }}</strong>
        </p>
      </div>
      <div class="flex gap-3 items-center">
        <!-- Botón para agregar tarea (mismo estilo que MiCartera) -->
        <button (click)="goBack()" class="text-white hover:underline flex items-center gap-1">
          <span class="material-icons">arrow_back</span> Regresar
        </button>

        <button (click)="openAddModal()"
          class="bg-white text-sky-800 px-4 py-2 rounded-md shadow-md hover:bg-slate-200 transition font-semibold flex items-center gap-2">
          <span class="material-icons text-sky-800">add</span> Agregar
        </button>
      </div>
    </div>

    <!-- Tabla de tareas -->
    <div class="overflow-x-auto">
      <table class="w-full min-w-[640px] border-collapse">
        <thead class="bg-gray-100">
          <tr class="border-b">
            <th class="py-4 px-6 text-left text-xs font-semibold uppercase text-gray-600">Nombre</th>
            <th class="py-4 px-6 text-left text-xs font-semibold uppercase text-gray-600">Nota</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Fecha</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Estado</th>
            <th class="py-4 px-6 text-center text-xs font-semibold uppercase text-gray-600">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let task of tasks" class="border-b transition duration-300 hover:bg-gray-50">
            <td class="py-4 px-6 font-semibold">{{ task.nombre }}</td>
            <td class="py-4 px-6 text-gray-700">{{ task.nota || '-' }}</td>
            <td class="py-4 px-6 text-center">
              {{ task.fecha ? (task.fecha | date:'EEEE d') : '(por definir)' }}
            </td>
            <td class="py-4 px-6 text-center">
              <select [(ngModel)]="task.estado" (change)="changeTaskStatus(task)"
                class="text-xs font-semibold px-3 py-1 rounded-full shadow-sm border text-white"
                [ngClass]="getEstadoColor(task)">

                <option class="text-black bg-slate-100" value="pendiente">Pendiente</option>
                <option class="text-black bg-slate-100" value="realizado">Realizado</option>
                <option class="text-black bg-slate-100" value="no realizado">No realizado</option>
                <option class="text-black bg-slate-100" value="para hoy">Para hoy</option>
              </select>
            </td>

            <td class="py-4 px-6 text-center">
              <button (click)="openEditModal(task)" class="text-sky-700 text-xl">
                <span class="material-icons text-sky-700">edit</span>
              </button>
              <button (click)="openDeleteModal(task)" class="text-orange-600 text-xl">
                <span class="material-icons text-orange-600">delete</span>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modal para agregar nueva tarea -->
<div *ngIf="isAddModalOpen" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-96">
    <h2 class="text-xl font-bold mb-4">Nueva Tarea</h2>

    <!-- Campo: Nombre -->
    <label class="block mb-1 font-medium">Nombre:</label>
    <input type="text" [(ngModel)]="newTask.nombre" class="w-full p-2 border rounded mb-4" />

    <!-- Campo: Nota -->
    <label class="block mb-1 font-medium">Nota adicional:</label>
    <textarea [(ngModel)]="newTask.nota" class="w-full p-2 border rounded mb-4" rows="2"></textarea>

    <!-- Campo: Fecha -->
    <label class="block mb-1 font-medium">Fecha (día):</label>
    <input type="date" [(ngModel)]="newTask.fecha" class="w-full p-2 border rounded mb-4" />

    <!-- Campo: Estado -->
    <!-- <label class="block mb-1 font-medium">Estado:</label>
    <select [(ngModel)]="newTask.estado" class="w-full p-2 border rounded mb-4">
      <option value="pendiente">pendiente</option>
      <option value="realizado">realizado</option>
      <option value="no realizado">no realizado</option>
      <option value="para hoy">para hoy</option>
    </select> -->

    <!-- Acciones -->
    <div class="flex justify-end gap-2">
      <button (click)="closeAddModal()" class="px-4 py-2 border rounded-md hover:bg-slate-200">Cancelar</button>
      <button (click)="addTask()"
        class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">Agregar</button>
    </div>
  </div>
</div>

<!-- Modal para editar tarea -->
<div *ngIf="isEditModalOpen" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-96">
    <h2 class="text-xl font-bold mb-4">Editar Tarea</h2>

    <!-- Campo: Nombre -->
    <label class="block mb-1 font-medium">Nombre:</label>
    <input type="text" [(ngModel)]="editedTask.nombre" class="w-full p-2 border rounded mb-4" />

    <!-- Campo: Nota -->
    <label class="block mb-1 font-medium">Nota:</label>
    <textarea [(ngModel)]="editedTask.nota" class="w-full p-2 border rounded mb-4" rows="2"></textarea>

    <!-- Campo: Fecha -->
    <label class="block mb-1 font-medium">Fecha:</label>
    <input type="date" [(ngModel)]="editedTask.fecha" class="w-full p-2 border rounded mb-4" />

    <!-- Campo: Estado -->
    <!-- <label class="block mb-1 font-medium">Estado:</label>
    <select [(ngModel)]="editedTask.estado" class="w-full p-2 border rounded mb-4">
      <option value="pendiente">pendiente</option>
      <option value="realizado">realizado</option>
      <option value="no realizado">no realizado</option>
      <option value="para hoy">para hoy</option>
    </select> -->

    <!-- Acciones -->
    <div class="flex justify-end gap-2">
      <button (click)="closeEditModal()" class="px-4 py-2 border rounded-md hover:bg-slate-200">Cancelar</button>
      <button (click)="saveTaskEdit()" class="px-4 py-2 bg-sky-700 text-white rounded-md hover:bg-sky-800">
        Guardar
      </button>
    </div>
  </div>
</div>

<!-- Modal para eliminar tarea -->
<div *ngIf="isDeleteModalOpen" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-40 z-50">
  <div class="bg-white p-6 rounded-lg shadow-lg w-80 text-center">
    <span class="material-icons text-red-600 mx-auto mb-4" style="font-size: 48px;">
      report_problem
    </span>
    <h2 class="text-xl font-bold mt-4 mb-2">¿Eliminar Tarea?</h2>
    <p class="mb-6 text-gray-700">¿Estás seguro de eliminar esta tarea? Esta acción no se puede deshacer.</p>
    <div class="flex justify-center gap-2">
      <button (click)="closeDeleteModal()" class="px-4 py-2 border rounded-md hover:bg-orange-200">Cancelar</button>
      <button (click)="confirmDeleteTask()" class="px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-red-600">
        Eliminar
      </button>
    </div>
  </div>
</div>
