"use strict";(self.webpackChunkmisDeberes=self.webpackChunkmisDeberes||[]).push([[539],{6539:(I,m,i)=>{i.r(m),i.d(m,{LoginComponent:()=>E});var e=i(4438),d=i(177),c=i(7471),r=i(9417),f=i(4796),p=i(3062);const g=s=>({"border-red-500":s});function b(s,u){1&s&&(e.j41(0,"p",14),e.EFF(1,"Correo inv\xe1lido."),e.k0s())}function v(s,u){1&s&&(e.j41(0,"p",14),e.EFF(1,"Debe tener al menos 6 caracteres."),e.k0s())}function _(s,u){if(1&s){const t=e.RV6();e.j41(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18),e.qSk(),e.j41(4,"svg",19),e.nrm(5,"path",20),e.k0s()()(),e.joV(),e.j41(6,"h3",21),e.EFF(7,"Error en Inicio de Sesi\xf3n"),e.k0s(),e.j41(8,"p",22),e.EFF(9),e.k0s(),e.j41(10,"button",23),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.closeModal())}),e.EFF(11," Cerrar "),e.k0s()()()}if(2&s){const t=e.XpG();e.R7$(9),e.JRh(t.errorMessage)}}function w(s,u){if(1&s&&(e.j41(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",24),e.qSk(),e.j41(4,"svg",25),e.nrm(5,"path",26),e.k0s()()(),e.joV(),e.j41(6,"h3",21),e.EFF(7),e.k0s()()()),2&s){const t=e.XpG();e.R7$(7),e.SpI("\xa1Bienvenido, ",t.welcomeName,"!")}}let E=(()=>{class s{constructor(){this.fb=(0,e.WQX)(r.ok),this.router=(0,e.WQX)(c.Ix),this.authService=(0,e.WQX)(f.u),this.dateService=(0,e.WQX)(p.k),this.showModal=!1,this.showSuccessModal=!1,this.errorMessage="",this.welcomeName="",this.loginForm=this.fb.group({email:["",[r.k0.required,r.k0.email]],password:["",[r.k0.required,r.k0.minLength(6)]]})}ngOnInit(){}isInvalid(t){return this.loginForm.controls[t].invalid&&this.loginForm.controls[t].touched}onSubmit(){if(this.loginForm.valid){const{email:t,password:n}=this.loginForm.value;this.authService.login(t,n).subscribe({next:o=>{const a=o.localId;this.authService.getUserData(a).subscribe(x=>{this.showWelcomeModal(x?.nombre||"");const M=["Reserv\xe1 al menos el 10% de tus ingresos como ahorro.","Evit\xe1 gastos peque\xf1os repetitivos, pueden sumar mucho.","Asign\xe1 metas a tus ahorros: eso te motiva m\xe1s."];this.authService.getUserNotifications(a).subscribe(h=>{const C=h?Object.values(h).map(l=>l.mensaje):[];M.forEach(l=>{C.includes(l)||this.authService.addNotification(a,l).subscribe()})})})},error:o=>{this.showErrorModal(this.getFirebaseErrorMessage(o))}})}}showErrorModal(t){this.errorMessage=t,this.showModal=!0}closeModal(){this.showModal=!1}showWelcomeModal(t){this.welcomeName=t,this.showSuccessModal=!0,this.dateService.resetToCurrentDate(),setTimeout(()=>{this.showSuccessModal=!1,this.router.navigate(["app/home"])},1e3)}getFirebaseErrorMessage(t){switch(t){case"EMAIL_NOT_FOUND":case"INVALID_PASSWORD":return"Correo o contrase\xf1a incorrectos.";case"USER_DISABLED":return"Este usuario ha sido deshabilitado.";default:return"Ha ocurrido un error inesperado."}}static{this.\u0275fac=function(n){return new(n||s)}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-login"]],standalone:!0,features:[e.aNF],decls:23,vars:12,consts:[[1,"flex","justify-center","items-center","h-screen","w-screen","bg-gradient-to-r","from-purple-900","to-sky-900"],[1,"bg-white","p-10","rounded-lg","shadow-lg","w-full","max-w-md"],[1,"text-center","text-3xl","font-bold","text-gray-700","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-6"],["for","email",1,"block","text-gray-600","text-sm","font-semibold"],["type","email","id","email","formControlName","email",1,"w-full","px-4","py-3","mt-2","border","rounded-lg","focus:ring","focus:ring-blue-300",3,"ngClass"],["class","text-red-500 text-xs mt-1",4,"ngIf"],["for","password",1,"block","text-gray-600","text-sm","font-semibold"],["type","password","id","password","formControlName","password",1,"w-full","px-4","py-3","mt-2","border","rounded-lg","focus:ring","focus:ring-blue-300",3,"ngClass"],["type","submit",1,"w-full","bg-blue-500","text-white","py-3","rounded-lg","shadow-md","hover:bg-blue-600","transition","disabled:opacity-50",3,"disabled"],[1,"text-center","text-sm","text-gray-500","mt-6"],["routerLink","/register",1,"text-blue-500","font-semibold","hover:underline"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"text-red-500","text-xs","mt-1"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-white","p-6","rounded-lg","shadow-lg","max-w-sm","w-full","relative"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","flex","items-center","justify-center","bg-red-100","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-8","w-8","text-red-500"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3-10a1 1 0 00-1.414-1.414L10 8.586 8.414 7A1 1 0 007 8.414L8.586 10 7 11.586A1 1 0 108.414 13L10 11.414l1.586 1.586A1 1 0 1013 11.586L11.414 10 13 8.414A1 1 0 0013 8z","clip-rule","evenodd"],[1,"text-xl","font-bold","text-gray-800","mb-4","text-center"],[1,"text-gray-600","text-center"],[1,"mt-4","w-full","bg-red-500","text-white","py-2","rounded-lg","hover:bg-red-600","transition",3,"click"],[1,"w-16","h-16","flex","items-center","justify-center","bg-green-100","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-8","w-8","text-green-500"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 000 16zm3-10l-4 4-2-2a1 1 0 00-1.414 1.414L10 14l5-5a1 1 0 00-1.414-1.414z","clip-rule","evenodd"]],template:function(n,o){1&n&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Iniciar Sesi\xf3n"),e.k0s(),e.j41(4,"form",3),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Correo Electr\xf3nico"),e.k0s(),e.nrm(8,"input",6),e.DNE(9,b,2,0,"p",7),e.k0s(),e.j41(10,"div",4)(11,"label",8),e.EFF(12,"Contrase\xf1a"),e.k0s(),e.nrm(13,"input",9),e.DNE(14,v,2,0,"p",7),e.k0s(),e.j41(15,"button",10),e.EFF(16," Iniciar Sesi\xf3n "),e.k0s(),e.j41(17,"p",11),e.EFF(18," \xbfNo tienes cuenta? "),e.j41(19,"a",12),e.EFF(20,"Reg\xedstrate"),e.k0s()()()()(),e.DNE(21,_,12,1,"div",13)(22,w,8,1,"div",13)),2&n&&(e.R7$(4),e.Y8G("formGroup",o.loginForm),e.R7$(4),e.Y8G("ngClass",e.eq3(8,g,o.isInvalid("email"))),e.R7$(),e.Y8G("ngIf",o.isInvalid("email")),e.R7$(4),e.Y8G("ngClass",e.eq3(10,g,o.isInvalid("password"))),e.R7$(),e.Y8G("ngIf",o.isInvalid("password")),e.R7$(),e.Y8G("disabled",o.loginForm.invalid),e.R7$(6),e.Y8G("ngIf",o.showModal),e.R7$(),e.Y8G("ngIf",o.showSuccessModal))},dependencies:[d.MD,d.YU,d.bT,c.iI,c.Wk,r.X1,r.qT,r.me,r.BC,r.cb,r.j4,r.JD]})}}return s})()}}]);