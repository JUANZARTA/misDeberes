"use strict";(self.webpackChunkmisDeberes=self.webpackChunkmisDeberes||[]).push([[76],{3062:(D,M,o)=>{o.d(M,{k:()=>m});var l=o(4438),E=o(177),i=o(4412),_=o(4572),u=o(6354),d=o(1562);let m=(()=>{class h{constructor(n,r){if(this.http=r,this.isBrowser=(0,E.UE)(n),this.isBrowser){const c=localStorage.getItem("selectedYear"),s=localStorage.getItem("selectedMonth");if(c&&s)this.yearSubject=new i.t(c),this.monthSubject=new i.t(s);else{const e=new Date,t=e.getFullYear().toString(),a=(e.getMonth()+1).toString().padStart(2,"0");localStorage.setItem("selectedYear",t),localStorage.setItem("selectedMonth",a),this.yearSubject=new i.t(t),this.monthSubject=new i.t(a)}}else this.yearSubject=new i.t(""),this.monthSubject=new i.t("")}get selectedYear$(){return this.yearSubject.asObservable()}get selectedMonth$(){return this.monthSubject.asObservable()}get selectedDate$(){return(0,_.z)([this.selectedYear$,this.selectedMonth$]).pipe((0,u.T)(([n,r])=>({year:n,month:r})))}setDate(n,r){const c=r.toString().padStart(2,"0");this.yearSubject.next(n.toString()),this.monthSubject.next(c),this.isBrowser&&(localStorage.setItem("selectedYear",n.toString()),localStorage.setItem("selectedMonth",c))}getSelectedYear(){return this.yearSubject.value}getSelectedMonth(){return this.monthSubject.value}resetToCurrentDate(){const n=new Date,r=n.getFullYear().toString(),c=(n.getMonth()+1).toString().padStart(2,"0");this.yearSubject.next(r),this.monthSubject.next(c),this.isBrowser&&(localStorage.setItem("selectedYear",r),localStorage.setItem("selectedMonth",c))}notifyMonthChange(n,r,c){const t=`https://micartera-acd5b-default-rtdb.firebaseio.com/${n}/notificaciones.json`,a={mensaje:`Nuevo mes detectado: ${this.getMonthName(c)} ${r}`,leido:!1,fecha:(new Date).toLocaleString()};this.http.post(t,a).subscribe()}getMonthName(n){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(n)-1]||""}static{this.\u0275fac=function(r){return new(r||h)(l.KVO(l.Agw),l.KVO(d.Qq))}}static{this.\u0275prov=l.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},9211:(D,M,o)=>{o.d(M,{z:()=>n});var l=o(6354),E=o(9437),i=o(5558),_=o(7673),u=o(8810),d=o(4438),m=o(4796),h=o(3062),O=o(1562);let n=(()=>{class r{constructor(s,e,t){this.authService=s,this.dateService=e,this.http=t,this.dbUrl="https://misdeberes-fac01-default-rtdb.firebaseio.com"}getPath(){const s=this.authService.getUser(),e=this.dateService.getSelectedYear(),t=this.dateService.getSelectedMonth();return s?.id&&e&&t?`${this.dbUrl}/${s.id}/${e}/${t}/categorias`:null}sanitizeKey(s){return s.trim().toLowerCase().replace(/\s+/g,"_")}getAllTaskTypes(){const s=this.getPath();return s?this.http.get(`${s}.json`).pipe((0,l.T)(t=>t?Object.keys(t).map(a=>({key:a,nombre:t[a]?.nombre||a})):[]),(0,E.W)(t=>(console.error("[ERROR][GET TYPES]",t),(0,_.of)([])))):(0,_.of)([])}addTaskType(s){const e=this.getPath();if(!e)return(0,u.$)(()=>new Error("Ruta no v\xe1lida"));const t=this.sanitizeKey(s);return this.http.put(`${e}/${t}.json`,{tareas:{},nombre:s})}deleteTaskType(s){const e=this.getPath();return e?this.http.delete(`${e}/${s}.json`):(0,u.$)(()=>new Error("Ruta no v\xe1lida"))}editTaskType(s,e){const t=this.getPath();if(!t)return(0,u.$)(()=>new Error("Ruta no v\xe1lida"));const a=this.sanitizeKey(e),S=`${t}/${s}.json`,v=`${t}/${a}.json`;return this.http.get(S).pipe((0,i.n)(g=>{const P={...g,nombre:e};return this.http.put(v,P)}),(0,i.n)(()=>this.http.delete(S)),(0,E.W)(g=>(console.error("[ERROR][EDIT TYPE]",g),(0,u.$)(()=>g))))}static{this.\u0275fac=function(e){return new(e||r)(d.KVO(m.u),d.KVO(h.k),d.KVO(O.Qq))}}static{this.\u0275prov=d.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})()}}]);