{"ast":null,"code":"import { map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./auth.service\";\nimport * as i2 from \"./date.service\";\nimport * as i3 from \"@angular/common/http\";\nexport let TaskTypeService = /*#__PURE__*/(() => {\n  class TaskTypeService {\n    constructor(authService, dateService, http) {\n      this.authService = authService;\n      this.dateService = dateService;\n      this.http = http;\n      this.dbUrl = 'https://misdeberes-fac01-default-rtdb.firebaseio.com';\n    }\n    getPath() {\n      const userId = this.authService.getUserId();\n      const {\n        year,\n        month\n      } = this.dateService.getCurrentDateInfo();\n      return `${this.dbUrl}/${userId}/${year}/${month}/categorias`;\n    }\n    getAllTaskTypes() {\n      const url = `${this.getPath()}.json`;\n      return this.http.get(url).pipe(map(response => response ? Object.keys(response) : []));\n    }\n    addTaskType(nombre) {\n      const url = `${this.getPath()}/${nombre}.json`;\n      return this.http.put(url, {\n        tareas: {}\n      });\n    }\n    deleteTaskType(nombre) {\n      const url = `${this.getPath()}/${nombre}.json`;\n      return this.http.delete(url);\n    }\n    editTaskType(oldName, newName) {\n      const path = this.getPath();\n      const oldUrl = `${path}/${oldName}.json`;\n      const newUrl = `${path}/${newName}.json`;\n      return this.http.get(oldUrl).pipe(map(data => {\n        return this.http.put(newUrl, data).subscribe(() => {\n          this.http.delete(oldUrl).subscribe();\n        });\n      }));\n    }\n    static #_ = this.ɵfac = function TaskTypeService_Factory(t) {\n      return new (t || TaskTypeService)(i0.ɵɵinject(i1.AuthService), i0.ɵɵinject(i2.DateService), i0.ɵɵinject(i3.HttpClient));\n    };\n    static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: TaskTypeService,\n      factory: TaskTypeService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return TaskTypeService;\n})();","map":{"version":3,"names":["map","TaskTypeService","constructor","authService","dateService","http","dbUrl","getPath","userId","getUserId","year","month","getCurrentDateInfo","getAllTaskTypes","url","get","pipe","response","Object","keys","addTaskType","nombre","put","tareas","deleteTaskType","delete","editTaskType","oldName","newName","path","oldUrl","newUrl","data","subscribe","_","i0","ɵɵinject","i1","AuthService","i2","DateService","i3","HttpClient","_2","factory","ɵfac","providedIn"],"sources":["E:\\Golden Panda\\8) Programacion\\MisDeberes\\misDeberes\\src\\app\\services\\taskType.service.ts"],"sourcesContent":["// Servicio para gestionar tipos de tareas (categorías) desde Firebase sin usar initializeApp\r\nimport { Injectable } from '@angular/core';\r\nimport { AuthService } from './auth.service';\r\nimport { DateService } from './date.service';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { environment } from 'src/environments/environment';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TaskTypeService {\r\n  private dbUrl = 'https://misdeberes-fac01-default-rtdb.firebaseio.com';\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private dateService: DateService,\r\n    private http: HttpClient\r\n  ) {}\r\n\r\n  private getPath() {\r\n    const userId = this.authService.getUserId();\r\n    const { year, month } = this.dateService.getCurrentDateInfo();\r\n    return `${this.dbUrl}/${userId}/${year}/${month}/categorias`;\r\n  }\r\n\r\n  getAllTaskTypes() {\r\n    const url = `${this.getPath()}.json`;\r\n    return this.http.get<{ [key: string]: any }>(url).pipe(\r\n      map(response => response ? Object.keys(response) : [])\r\n    );\r\n  }\r\n\r\n  addTaskType(nombre: string) {\r\n    const url = `${this.getPath()}/${nombre}.json`;\r\n    return this.http.put(url, { tareas: {} });\r\n  }\r\n\r\n  deleteTaskType(nombre: string) {\r\n    const url = `${this.getPath()}/${nombre}.json`;\r\n    return this.http.delete(url);\r\n  }\r\n\r\n  editTaskType(oldName: string, newName: string) {\r\n    const path = this.getPath();\r\n    const oldUrl = `${path}/${oldName}.json`;\r\n    const newUrl = `${path}/${newName}.json`;\r\n\r\n    return this.http.get(oldUrl).pipe(\r\n      map(data => {\r\n        return this.http.put(newUrl, data).subscribe(() => {\r\n          this.http.delete(oldUrl).subscribe();\r\n        });\r\n      })\r\n    );\r\n  }\r\n}\r\n"],"mappings":"AAMA,SAASA,GAAG,QAAQ,gBAAgB;;;;;AAKpC,WAAaC,eAAe;EAAtB,MAAOA,eAAe;IAG1BC,YACUC,WAAwB,EACxBC,WAAwB,EACxBC,IAAgB;MAFhB,KAAAF,WAAW,GAAXA,WAAW;MACX,KAAAC,WAAW,GAAXA,WAAW;MACX,KAAAC,IAAI,GAAJA,IAAI;MALN,KAAAC,KAAK,GAAG,sDAAsD;IAMnE;IAEKC,OAAOA,CAAA;MACb,MAAMC,MAAM,GAAG,IAAI,CAACL,WAAW,CAACM,SAAS,EAAE;MAC3C,MAAM;QAAEC,IAAI;QAAEC;MAAK,CAAE,GAAG,IAAI,CAACP,WAAW,CAACQ,kBAAkB,EAAE;MAC7D,OAAO,GAAG,IAAI,CAACN,KAAK,IAAIE,MAAM,IAAIE,IAAI,IAAIC,KAAK,aAAa;IAC9D;IAEAE,eAAeA,CAAA;MACb,MAAMC,GAAG,GAAG,GAAG,IAAI,CAACP,OAAO,EAAE,OAAO;MACpC,OAAO,IAAI,CAACF,IAAI,CAACU,GAAG,CAAyBD,GAAG,CAAC,CAACE,IAAI,CACpDhB,GAAG,CAACiB,QAAQ,IAAIA,QAAQ,GAAGC,MAAM,CAACC,IAAI,CAACF,QAAQ,CAAC,GAAG,EAAE,CAAC,CACvD;IACH;IAEAG,WAAWA,CAACC,MAAc;MACxB,MAAMP,GAAG,GAAG,GAAG,IAAI,CAACP,OAAO,EAAE,IAAIc,MAAM,OAAO;MAC9C,OAAO,IAAI,CAAChB,IAAI,CAACiB,GAAG,CAACR,GAAG,EAAE;QAAES,MAAM,EAAE;MAAE,CAAE,CAAC;IAC3C;IAEAC,cAAcA,CAACH,MAAc;MAC3B,MAAMP,GAAG,GAAG,GAAG,IAAI,CAACP,OAAO,EAAE,IAAIc,MAAM,OAAO;MAC9C,OAAO,IAAI,CAAChB,IAAI,CAACoB,MAAM,CAACX,GAAG,CAAC;IAC9B;IAEAY,YAAYA,CAACC,OAAe,EAAEC,OAAe;MAC3C,MAAMC,IAAI,GAAG,IAAI,CAACtB,OAAO,EAAE;MAC3B,MAAMuB,MAAM,GAAG,GAAGD,IAAI,IAAIF,OAAO,OAAO;MACxC,MAAMI,MAAM,GAAG,GAAGF,IAAI,IAAID,OAAO,OAAO;MAExC,OAAO,IAAI,CAACvB,IAAI,CAACU,GAAG,CAACe,MAAM,CAAC,CAACd,IAAI,CAC/BhB,GAAG,CAACgC,IAAI,IAAG;QACT,OAAO,IAAI,CAAC3B,IAAI,CAACiB,GAAG,CAACS,MAAM,EAAEC,IAAI,CAAC,CAACC,SAAS,CAAC,MAAK;UAChD,IAAI,CAAC5B,IAAI,CAACoB,MAAM,CAACK,MAAM,CAAC,CAACG,SAAS,EAAE;QACtC,CAAC,CAAC;MACJ,CAAC,CAAC,CACH;IACH;IAAC,QAAAC,CAAA,G;uBA5CUjC,eAAe,EAAAkC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,WAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,WAAA,GAAAL,EAAA,CAAAC,QAAA,CAAAK,EAAA,CAAAC,UAAA;IAAA;IAAA,QAAAC,EAAA,G;aAAf1C,eAAe;MAAA2C,OAAA,EAAf3C,eAAe,CAAA4C,IAAA;MAAAC,UAAA,EAFd;IAAM;;SAEP7C,eAAe;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}