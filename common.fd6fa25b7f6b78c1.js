"use strict";(self.webpackChunkmisDeberes=self.webpackChunkmisDeberes||[]).push([[76],{9211:(M,l,s)=>{s.d(l,{z:()=>D});var d=s(6354),c=s(9437),E=s(5558),u=s(7673),a=s(8810),i=s(4438),P=s(4796),O=s(3062),p=s(1626);let D=(()=>{class o{constructor(e,r,t){this.authService=e,this.dateService=r,this.http=t,this.dbUrl="https://misdeberes-fac01-default-rtdb.firebaseio.com"}getPath(){const e=this.authService.getUser(),r=this.dateService.getSelectedYear(),t=this.dateService.getSelectedMonth();return e?.id&&r&&t?`${this.dbUrl}/${e.id}/${r}/${t}/categorias`:null}sanitizeKey(e){return e.trim().toLowerCase().replace(/\s+/g,"_")}getAllTaskTypes(){const e=this.getPath();return e?this.http.get(`${e}.json`).pipe((0,d.T)(t=>t?Object.keys(t).map(n=>({key:n,nombre:t[n]?.nombre||n})):[]),(0,c.W)(t=>(console.error("[ERROR][GET TYPES]",t),(0,u.of)([])))):(0,u.of)([])}addTaskType(e){const r=this.getPath();if(!r)return(0,a.$)(()=>new Error("Ruta no v\xe1lida"));const t=this.sanitizeKey(e);return this.http.put(`${r}/${t}.json`,{tareas:{},nombre:e})}deleteTaskType(e){const r=this.getPath();return r?this.http.delete(`${r}/${e}.json`):(0,a.$)(()=>new Error("Ruta no v\xe1lida"))}editTaskType(e,r){const t=this.getPath();if(!t)return(0,a.$)(()=>new Error("Ruta no v\xe1lida"));const n=this.sanitizeKey(r),_=`${t}/${e}.json`,T=`${t}/${n}.json`;return this.http.get(_).pipe((0,E.n)(h=>{const v={...h,nombre:r};return this.http.put(T,v)}),(0,E.n)(()=>this.http.delete(_)),(0,c.W)(h=>(console.error("[ERROR][EDIT TYPE]",h),(0,a.$)(()=>h))))}static{this.\u0275fac=function(r){return new(r||o)(i.KVO(P.u),i.KVO(O.k),i.KVO(p.Qq))}}static{this.\u0275prov=i.jDH({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})()}}]);