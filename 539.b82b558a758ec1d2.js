"use strict";(self.webpackChunkmisDeberes=self.webpackChunkmisDeberes||[]).push([[539],{6539:(j,p,r)=>{r.r(p),r.d(p,{LoginComponent:()=>h});var e=r(4438),b=r(177),d=r(7471),a=r(9417),v=r(4796),w=r(3062),E=r(7935);r(9966);const M=o=>({"border-red-500":o});function i(o,u){1&o&&(e.j41(0,"p",21),e.EFF(1,"Correo inv\xe1lido."),e.k0s())}function n(o,u){1&o&&(e.j41(0,"p",21),e.EFF(1,"Debe tener al menos 6 caracteres."),e.k0s())}function l(o,u){if(1&o){const t=e.RV6();e.j41(0,"div",22)(1,"div",23)(2,"div",24)(3,"div",25),e.qSk(),e.j41(4,"svg",26),e.nrm(5,"path",27),e.k0s()()(),e.joV(),e.j41(6,"h3",28),e.EFF(7,"Error en Inicio de Sesi\xf3n"),e.k0s(),e.j41(8,"p",29),e.EFF(9),e.k0s(),e.j41(10,"button",30),e.bIt("click",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.closeModal())}),e.EFF(11," Cerrar "),e.k0s()()()}if(2&o){const t=e.XpG();e.R7$(9),e.JRh(t.errorMessage)}}function f(o,u){if(1&o&&(e.j41(0,"div",22)(1,"div",23)(2,"div",24)(3,"div",31),e.qSk(),e.j41(4,"svg",32),e.nrm(5,"path",33),e.k0s()()(),e.joV(),e.j41(6,"h3",28),e.EFF(7),e.k0s()()()),2&o){const t=e.XpG();e.R7$(7),e.SpI("\xa1Bienvenido, ",t.welcomeName,"!")}}let h=(()=>{class o{constructor(){this.fb=(0,e.WQX)(a.ok),this.router=(0,e.WQX)(d.Ix),this.authService=(0,e.WQX)(v.u),this.dateService=(0,e.WQX)(w.k),this.showPassword=!1,this.showModal=!1,this.showSuccessModal=!1,this.errorMessage="",this.welcomeName="",this.loginForm=this.fb.group({email:["",[a.k0.required,a.k0.email]],password:["",[a.k0.required,a.k0.minLength(6)]]})}ngOnInit(){E.A.auth().getRedirectResult().then(t=>{t&&t.user&&(this.welcomeName=t.user.displayName||"Usuario",this.showSuccessModal=!0,setTimeout(()=>{this.router.navigate(["app/home"])},1e3))}).catch(t=>{console.error("Error en getRedirectResult:",t)})}isInvalid(t){const c=this.loginForm.get(t);return!(!c||!c.invalid||!c.dirty&&!c.touched)}onSubmit(){if(this.loginForm.valid){const{email:t,password:c}=this.loginForm.value;this.authService.login(t,c).subscribe({next:s=>{const g=s.localId;this.authService.getUserData(g).subscribe(x=>{this.showWelcomeModal(x?.nombre||"");const I=["Reserv\xe1 al menos el 10% de tus ingresos como ahorro.","Evit\xe1 gastos peque\xf1os repetitivos, pueden sumar mucho.","Asign\xe1 metas a tus ahorros: eso te motiva m\xe1s."];this.authService.getUserNotifications(g).subscribe(S=>{const y=S?Object.values(S).map(_=>_.mensaje):[];I.forEach(_=>{y.includes(_)||this.authService.addNotification(g,_).subscribe()})})})},error:s=>{this.showErrorModal(this.getFirebaseErrorMessage(s))}})}}showErrorModal(t){this.errorMessage=t,this.showModal=!0}closeModal(){this.showModal=!1}showWelcomeModal(t){this.welcomeName=t,this.showSuccessModal=!0,this.dateService.resetToCurrentDate(),setTimeout(()=>{this.showSuccessModal=!1,this.router.navigate(["app/home"])},1e3)}getFirebaseErrorMessage(t){switch(t){case"EMAIL_NOT_FOUND":case"INVALID_PASSWORD":return"Correo o contrase\xf1a incorrectos.";case"USER_DISABLED":return"Este usuario ha sido deshabilitado.";default:return"Ha ocurrido un error inesperado."}}togglePasswordVisibility(){this.showPassword=!this.showPassword}onLoginWithGoogle(){this.authService.loginWithGoogle()}static{this.\u0275fac=function(c){return new(c||o)}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-login"]],standalone:!0,features:[e.aNF],decls:32,vars:14,consts:[[1,"flex","justify-center","items-center","h-screen","w-screen","bg-gradient-to-r","from-slate-900","to-teal-700"],[1,"bg-white","p-10","rounded-lg","shadow-lg","w-full","max-w-md"],[1,"text-center","text-3xl","font-bold","text-gray-700","mb-6"],[1,"text-center","text-xl","font-bold","text-gray-700","mb-6"],[3,"ngSubmit","formGroup"],[1,"mb-6"],["for","email",1,"block","text-gray-600","text-sm","font-semibold"],["type","email","id","email","formControlName","email",1,"w-full","px-4","py-3","mt-2","border","rounded-lg","focus:ring","focus:ring-blue-300",3,"ngClass"],["class","text-red-500 text-xs mt-1",4,"ngIf"],[1,"mb-6","relative"],["for","password",1,"block","text-gray-600","text-sm","font-semibold"],["id","password","formControlName","password",1,"w-full","px-4","py-3","mt-2","border","rounded-lg","focus:ring","focus:ring-blue-300","pr-10",3,"type","ngClass"],["type","button",1,"absolute","right-3","top-10","text-gray-500","focus:outline-none",3,"click"],[1,"material-icons"],["type","submit",1,"w-full","bg-teal-500","text-white","py-3","rounded-lg","shadow-md","hover:bg-teal-700","transition","disabled:opacity-50",3,"disabled"],["type","button",1,"w-full","bg-white","text-black","border","border-gray-300","py-3","rounded-full","shadow-md","hover:bg-gray-100","transition","mt-4","flex","items-center","justify-center","gap-3",3,"click"],["src","https://developers.google.com/identity/images/g-logo.png","alt","Google logo",1,"w-6","h-6"],[1,"font-semibold"],[1,"text-center","text-sm","text-gray-500","mt-6"],["routerLink","/register",1,"text-blue-500","font-semibold","hover:underline"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",4,"ngIf"],[1,"text-red-500","text-xs","mt-1"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50"],[1,"bg-white","p-6","rounded-lg","shadow-lg","max-w-sm","w-full","relative"],[1,"flex","justify-center","mb-4"],[1,"w-16","h-16","flex","items-center","justify-center","bg-red-100","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-8","w-8","text-red-500"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3-10a1 1 0 00-1.414-1.414L10 8.586 8.414 7A1 1 0 007 8.414L8.586 10 7 11.586A1 1 0 108.414 13L10 11.414l1.586 1.586A1 1 0 1013 11.586L11.414 10 13 8.414A1 1 0 0013 8z","clip-rule","evenodd"],[1,"text-xl","font-bold","text-gray-800","mb-4","text-center"],[1,"text-gray-600","text-center"],[1,"mt-4","w-full","bg-red-500","text-white","py-2","rounded-lg","hover:bg-red-600","transition",3,"click"],[1,"w-16","h-16","flex","items-center","justify-center","bg-green-100","rounded-full"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-8","w-8","text-green-500"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 000 16zm3-10l-4 4-2-2a1 1 0 00-1.414 1.414L10 14l5-5a1 1 0 00-1.414-1.414z","clip-rule","evenodd"]],template:function(c,s){1&c&&(e.j41(0,"div",0)(1,"div",1)(2,"h2",2),e.EFF(3,"Mis Deberes"),e.k0s(),e.j41(4,"h2",3),e.EFF(5,"Iniciar Sesi\xf3n"),e.k0s(),e.j41(6,"form",4),e.bIt("ngSubmit",function(){return s.onSubmit()}),e.j41(7,"div",5)(8,"label",6),e.EFF(9,"Correo Electr\xf3nico"),e.k0s(),e.nrm(10,"input",7),e.DNE(11,i,2,0,"p",8),e.k0s(),e.j41(12,"div",9)(13,"label",10),e.EFF(14,"Contrase\xf1a"),e.k0s(),e.nrm(15,"input",11),e.j41(16,"button",12),e.bIt("click",function(){return s.togglePasswordVisibility()}),e.j41(17,"span",13),e.EFF(18),e.k0s()(),e.DNE(19,n,2,0,"p",8),e.k0s(),e.j41(20,"button",14),e.EFF(21," Iniciar Sesi\xf3n "),e.k0s(),e.j41(22,"button",15),e.bIt("click",function(){return s.onLoginWithGoogle()}),e.nrm(23,"img",16),e.j41(24,"span",17),e.EFF(25,"Iniciar sesi\xf3n con Google"),e.k0s()(),e.j41(26,"p",18),e.EFF(27," \xbfNo tienes cuenta? "),e.j41(28,"a",19),e.EFF(29,"Reg\xedstrate"),e.k0s()()()()(),e.DNE(30,l,12,1,"div",20)(31,f,8,1,"div",20)),2&c&&(e.R7$(6),e.Y8G("formGroup",s.loginForm),e.R7$(4),e.Y8G("ngClass",e.eq3(10,M,s.isInvalid("email"))),e.R7$(),e.Y8G("ngIf",s.isInvalid("email")),e.R7$(4),e.Y8G("type",s.showPassword?"text":"password")("ngClass",e.eq3(12,M,s.isInvalid("password"))),e.R7$(3),e.SpI(" ",s.showPassword?"visibility_off":"visibility"," "),e.R7$(),e.Y8G("ngIf",s.isInvalid("password")),e.R7$(),e.Y8G("disabled",s.loginForm.invalid),e.R7$(10),e.Y8G("ngIf",s.showModal),e.R7$(),e.Y8G("ngIf",s.showSuccessModal))},dependencies:[b.MD,b.YU,b.bT,d.iI,d.Wk,a.X1,a.qT,a.me,a.BC,a.cb,a.j4,a.JD]})}}return o})()},3062:(j,p,r)=>{r.d(p,{k:()=>E});var e=r(4438),b=r(177),d=r(4412),a=r(4572),v=r(6354),w=r(1626);let E=(()=>{class m{constructor(i,n){if(this.http=n,this.isBrowser=(0,b.UE)(i),this.isBrowser){const l=localStorage.getItem("selectedYear"),f=localStorage.getItem("selectedMonth");if(l&&f)this.yearSubject=new d.t(l),this.monthSubject=new d.t(f);else{const h=new Date,o=h.getFullYear().toString(),u=(h.getMonth()+1).toString().padStart(2,"0");localStorage.setItem("selectedYear",o),localStorage.setItem("selectedMonth",u),this.yearSubject=new d.t(o),this.monthSubject=new d.t(u)}}else this.yearSubject=new d.t(""),this.monthSubject=new d.t("")}get selectedYear$(){return this.yearSubject.asObservable()}get selectedMonth$(){return this.monthSubject.asObservable()}get selectedDate$(){return(0,a.z)([this.selectedYear$,this.selectedMonth$]).pipe((0,v.T)(([i,n])=>({year:i,month:n})))}setDate(i,n){const l=n.toString().padStart(2,"0");this.yearSubject.next(i.toString()),this.monthSubject.next(l),this.isBrowser&&(localStorage.setItem("selectedYear",i.toString()),localStorage.setItem("selectedMonth",l))}getSelectedYear(){return this.yearSubject.value}getSelectedMonth(){return this.monthSubject.value}resetToCurrentDate(){const i=new Date,n=i.getFullYear().toString(),l=(i.getMonth()+1).toString().padStart(2,"0");this.yearSubject.next(n),this.monthSubject.next(l),this.isBrowser&&(localStorage.setItem("selectedYear",n),localStorage.setItem("selectedMonth",l))}notifyMonthChange(i,n,l){const o=`https://micartera-acd5b-default-rtdb.firebaseio.com/${i}/notificaciones.json`,u={mensaje:`Nuevo mes detectado: ${this.getMonthName(l)} ${n}`,leido:!1,fecha:(new Date).toLocaleString()};this.http.post(o,u).subscribe()}getMonthName(i){return["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(i)-1]||""}static{this.\u0275fac=function(n){return new(n||m)(e.KVO(e.Agw),e.KVO(w.Qq))}}static{this.\u0275prov=e.jDH({token:m,factory:m.\u0275fac,providedIn:"root"})}}return m})()}}]);